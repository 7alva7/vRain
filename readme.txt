
      +--------------------------------------------+
      | vRain - 兀雨古籍刻本风格直排电子书制作工具 |
      |                    作者：兀雨书屋【小红书】|
      +--------------------------------------------+

*本程序能够实现中英文标点符号、数字替换并可编辑增加规则，但仍建议优先编辑原始文本为中文数字和标点符号。
*特殊字符：'@'代表空格，'%'代表强制换页符，'【】'内为批注文字。

一：目录结构

vRain/
  |__ vrain - 主程序，用于将指定书籍下text目录中的指定范围的txt文档转换为PDF格式直排电子书
  |__ canvas/
  |    |____ canvas - 古籍刻本书叶风格背景图生成程序
  |    |____ 01_Black.cfg - 背景图配置文件
  |    |____ 01.Black.jpg - 01_Black.cfg配置文件生成的背景图
  |    |____ ...
  |__ books/
  |    |____ 01/ - 书籍编号
  |    |     |____ book.cfg - 该书籍的配置文件
  |    |     |____ text/ - 该书籍包含的txt文本，按照阿拉伯数字编号
  |    |             |____ 1.txt
  |    |             |____ 2.txt
  |    |             |____ ...
  |    |____ 02/
  |    |____ ...
  |__ fonts/ - 字体目录
  |__ *.pdf - vrain生成的PDF电子书文件
  |__ sn.txt - SN序列号

二：QuickStart

%./vrain -h                                                                                                                                                  ✔  10075  13:25:18
  ./vrain 兀雨古籍刻本直排电子书制作工具
	-h	帮助信息
	-v	显示更多信息
	-z	测试模式，仅输出指定页数，用于调试参数
	-b	书籍ID
	-f	书籍TEXT文本的起始序号
	-t	书籍TEXT文本的结束序号
		作者：兀雨书屋【小红书】

%./vrain -b 01 -f 1 -t 1
------------------------------------------------------------
	vRain v1.0，兀雨古籍刻本电子书制作工具
		作者：兀雨书屋【小红书】
------------------------------------------------------------
read 'books/01/book.cfg'...
	标题：封神演義
	作者：明許仲琳著
	背景：01_Blue
	每列字数：24
	是否无标点：0
	标点归一化：0
read 'canvas/01_Blue.cfg'...
	尺寸：2480 x 1860
	列数：24
load 'books/01/text/*.txt' ... 10 text files done
read 'books/01/text/1.txt ...
creat new page [1] ...
creat new page [2] ...
creat new page [3] ...
creat new page [4] ...
creat new page [5] ...
creat new page [6] ...
save to 'books/01/《封神演義》文本1至1.pdf' ... done

三：制作步骤

1、canvas/目录下预制三个背景图，分辨率为2480*1860（即10.3英寸300ppi对应像素），框线颜色分别为黑、蓝、红。复制并编辑存在的.cfg文件，可制作新的背景图，如调整留白空间、修改每叶列数、设置自己的书房名称等，建议按照序号排序便于管理，参考指令：
%./canvas -c 02_Black.cfg

2、books/目录下预制01/、02/两本书样例，排版配置文件位于对应目录下book.cfg。
（1）新建03/目录，将样例01中的book.cfg拷贝到03/目录下，编辑更新。
（2）新建03/text目录，将该书相关txt文件编号后放到该目录下。
（3）执行测试指令：
%./vrain -z 3 -b 03 -f 1 -t 1
该指令读取03号书籍text目录下排序第1的文件，仅输出前三页到测试PDF文件，根据测试文件效果调整book.cfg的参数。
（4）book.cfg参数调测完成后，开始批量制作书籍
例如03/为100回白话小说，text目录下按回保存文件，分为上、中、下三册：
上册	%./vrain -b 03 -f 1 -t 33
中册	%./vrain -b 03 -f 34 -t 66
下册	%./vrain -b 03 -f 67 -t 100
例如03/为16卷诗集，text目录下按卷保存文：
卷一	   %./vrain -b 03 -f 1 -t 1
卷一至三   %./vrain -b 03 -f 1 -t 3

四：配置文件关键参数

1、canvas/01_Black.cfg 背景图配置关键参数

leaf_col=24 -> 书叶列数
logo_text=兀雨书屋 -> 制作者logo文字，按需更新为自己的文字

2、books/01/book.cfg 书籍排版关键参数

title=封神演義
author=明許仲琳著
canvas_id=01_Blue #古籍刻本背景图ID
row_num=24 #每列字数

#标点符号处理规则
exp_delete_comma=．|… #删除的标点符号，以|分隔
if_nocomma=0 #无标点符号模式
exp_nocomma=、|，|。|：|；|！|？|（|）|「|」|『|』|〔|〕|《|》 #无标点符号模式下过滤的标点符号, if_nocomma为1时有效
if_onlyperiod=0 #标点符号归一化为句号
exp_onlyperiod=、|，|。|：|；|！|？|（|）|「|」|『|』|《|》 #归一化为句号的标点符号，if_onlyperiod为1时有效

#正文标点符号
text_comma_nop=、|，|。|：|；|！|？ #不占独立字符位置的标点符号
text_comma_90=（）「」『』⋯…〔〕《》 #旋转90度的标点符号

#批注标点符号
comment_comma_nop=、|，|。|：|；|！|？
comment_comma_90=（）「」『』⋯…〔〕《》

